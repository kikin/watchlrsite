{% extends "user_home.html" %}
{% load kikinvideo_tags %}

{% block script_refs %}
    <script type="text/javascript">activeTab = TAB_SELECTORS.likes;</script>
    <script type="text/javascript" src="{{ settings.STATIC_URL }}js/kikin_video_panel.js"></script>
    <script type="text/javascript" src="{{ settings.STATIC_URL }}js/kikin_user_home.js"></script>
    <script type="text/javascript" src="{{ settings.STATIC_URL }}js/kikin_user_profile.js"></script>
{% endblock script_refs %}

{% block style_refs %}
    <link rel='stylesheet' type='text/css' href='{{ settings.STATIC_URL }}css/profile.css'/>
{% endblock style_refs %}

{% block content %}
    <meta name="profile_subject" content="{{ profile_owner.id }}"/>
    <div id="user-info-container">
				<div class="inner">
                    <div id="facebook-img" class="shadow-5l" style="background-image:url('https://graph.facebook.com/{{ profile_owner.facebook_uid }}/picture?type=normal');"></div>
					<div id="username-display">
							<div class="primary">
								{{ profile_owner.username }}
							</div>
							<div class="sub">
								({{ profile_owner.first_name }} {{ profile_owner.last_name }})
							</div>
						<div class="profile-basic-statistics shadow-5l" style="left:145px;">
							{{ profile_owner|total_liked_videos }}
							<div class="profile-basic-statistics-sub">
							Liked<br>videos
							</div>
						</div>
						<div class="profile-basic-statistics shadow-5l" style="left:258px;">
                            <div id="follower-count-user-{{ profile_owner.id }}">
							{{ profile_owner.followers|length }}
                            </div>
							<div class="profile-basic-statistics-sub" style="margin-top:10px;">
							Followers
							</div>
						</div>
                        <div class="profile-basic-statistics shadow-5l" style="left:370px;">
							{{ profile_owner.following|length }}
							<div class="profile-basic-statistics-sub">
							Followed<br>users
							</div>
						</div>
                        {% if not is_own_profile %}
                            {% if profile_owner in user.following %}
                                <a href="#!/unfollow?user={{ profile_owner.id }}" id="follow-link-user-{{ profile_owner.id }}">
                                    <div id="follow-button-user-{{ profile_owner.id }}" class="follow-button" class='shadow-5l'>Unfollow</div>
                                </a>
                            {% else %}
                                <a href="#!/follow?user={{ profile_owner.id }}" id="follow-link-user-{{ profile_owner.id }}">
                                    <div id="follow-button-user-{{ profile_owner.id }}" class="follow-button" class='shadow-5l'>Follow</div>
                                </a>
                            {% endif %}
                    {% endif %}
					</div>
				</div>
			</div>

    <div id="recent-activity-titlebar">
    {{ profile_owner.first_name|possessive }} video stream
    </div>
    <div id="videoListWrapper">
    <div id="videoList">
    {% for video in videos %}
        <div id="video-{{video.id}}" class="video-wrapper">
            <div class="video-container">
                <h3 class="video-title"><a href="/detail?vid={{video.id}}">{{ video.title }}</a></h3>

                <div class="video-buttons">

                    {% comment %}
                    .......until I have the time to implement it.....
                    <a href="#!/save_video?vid={{ video.id }}" title="add to my queue">
                        <div class="save-video-button no-hover" id="save-video-button-vid-{{ video.id }}"></div>
                    </a>
                    {% endcomment %}

                    <div class ="video-liked-info"id="video-liked-info-vid-{{ video.id }}">
                    {% if video.total_likes != 0 %}
                        {{ video.total_likes }}
                    {%  endif %}
                    </div>

                    <a>
                    {% if video in profile_owner.liked_videos %}
                        <div class="heart-container liked" id="liked-icon-vid-{{ video.id }}"></div>
                    {% else %}
                        <div class="heart-container no-hover" id="liked-icon-vid-{{ video.id }}"></div>
                    {% endif %}
                   </a>

                </div>
                <a href="#!/player?vid={{ video.id }}">
                    <div class="video-image" id="video-{{ video.id }}">
                        <div class="video-thumb-wrapper">
                            <img class="video-thumbnail" src="{{video.get_thumbnail.url}}"
                                 onerror="this.style.visibility='hidden'"
                                 onload="if(this.height<147) this.style.marginTop = (147-this.height)+'px'"/>

                            <div class="abs-position">
                                <div class="video-thumbnail-btn" id="video-thumbnail-btn-vid-{{ video.id }}"></div>
                            </div>
                        </div>
                    </div>
                </a>

                <div class="video-info">
                    <div class="video-description">{{ video.description }}</div>
                    <div class="video-saved">
                        <a href="{{video.url}}">{{ video.title }}</a>
                    </div>
                </div>

                <br style="clear:both;"/>

                {% if video.html_embed_code or video.html5_embed_code %}

                <div class="video-player" id="video-player-{{ video.id }}">
                    <div>
                        <a href="#!/close_player?vid={{ video.id }}" class="video-player-close"></a>
                    </div>
                    <div class='video-embed-container' id="video-embed-container-{{ video.id }}">
                    {% autoescape off %}
                        {{ video.html_embed_code }}
                    {% endautoescape %}
                    </div>
                </div>

                {% else %}

                <div class="video-player" id="video-player-{{ video.id }}"
                        style="background-color:#DEDEDE;font-size:16px;">
                    <div>
                        <a href="#!/close_player?vid={{ video.id }}" class="video-player-close"></a>
                    </div>
                    <div class='video-embed-container' id="video-embed-container-{{ video.id }}">
                        <div class="video-no-embed-link">
                            The host of the video you have selected requests that
                            you access it at<br>
                            <a href="{{ video.url }}" target="_blank">{{ video.url }}</a>
                        </div>
                    </div>
                </div>

                {% endif %}
            </div>
            <div class="my-video-breaker"></div>
        </div>
    {% endfor %}
    </div>
    </div>
{% endblock content%}
