{% extends "user_home.html" %}
{% load kikinvideo_tags %}

{% block script_refs %}
    <script type="text/javascript" src="{{ settings.STATIC_URL }}js/kikin_video_panel.js"></script>
    <script type="text/javascript" src="{{ settings.STATIC_URL }}js/kikin_user_home.js"></script>
{% endblock script_refs %}

{% block style_refs %}
    <link rel='stylesheet' type='text/css' href='{{ settings.STATIC_URL }}css/profile.css'/>
{% endblock style_refs %}

{% block content %}

    <div id="user-info-container">
				<div class="inner">
					<div id="profile-image-container">
                    <img id="facebook-thumbnail" src="https://graph.facebook.com/{{ user.facebook_uid }}/picture?type=small"/>
					</div>
					<div id="username-display">
							<div class="primary">
								{{ user.username }}
							</div>
							<div class="sub">
								{{ user.first_name }} {{ user.last_name }}
							</div>
						<div class="profile-basic-statistics" style="left:205px;">
							{{ user|total_liked_videos }}
							<div class="sub">
							Saved<br>videos
							</div>
						</div>
						<div class="profile-vertical-separator" style="left:245px;"></div>
						<div class="profile-basic-statistics" style="left:260px;">
							{{ user|total_saved_videos }}
							<div class="sub">
							Liked<br>videos
							</div>
						</div>
						<!--<div id="follow-button">Follow</div>-->
					</div>
					<img src="{{ settings.STATIC_URL }}images/profile/delta.png" id="delta-img"/>
				</div>
			</div>

    <div id="recent-activity-titlebar">
    {{ user.first_name|possessive }} video stream
    </div>
    {% for video in videos %}
        <div id="video-{{video.id}}" class="video-wrapper">
            <div class="video-container">
                <h3 class="video-title"><a href="/detail?vid={{video.id}}">{{ video.title }}</a></h3>

                <div class="video-buttons">

                    {% comment %}
                    .......until I have the time to implement it.....
                    <a href="#!/save_video?vid={{ video.id }}" title="add to my queue">
                        <div class="save-video-button no-hover" id="save-video-button-vid-{{ video.id }}"></div>
                    </a>
                    {% endcomment %}

                    <div class ="video-liked-info"id="video-liked-info-vid-{{ video.id }}">
                    {% if video.total_likes != 0 %}
                        {{ video.total_likes }}
                    {%  endif %}
                    </div>

                    <a>
                    {% if video in user.liked_videos %}
                        <div class="heart-container liked" id="liked-icon-vid-{{ video.id }}"></div>
                    {% else %}
                        <div class="heart-container no-hover" id="liked-icon-vid-{{ video.id }}"></div>
                    {% endif %}
                   </a>

                </div>
                <a href="#!/player?vid={{ video.id }}">
                    <div class="video-image" id="video-{{ video.id }}">
                        <div class="video-thumb-wrapper">
                            <img class="video-thumbnail" src="{{video.get_thumbnail.url}}"
                                 onerror="this.style.visibility='hidden'"
                                 onload="if(this.height<147) this.style.marginTop = (147-this.height)+'px'"/>

                            <div class="abs-position">
                                <div class="video-thumbnail-btn" id="video-thumbnail-btn-vid-{{ video.id }}"></div>
                            </div>
                        </div>
                    </div>
                </a>

                <div class="video-info">
                    <div class="video-description">{{ video.description }}</div>
                    <div class="video-saved">
                        <a href="{{video.url}}">{{ video.title }}</a>
                    </div>
                </div>

                <br style="clear:both;"/>

                {% if video.html_embed_code or video.html5_embed_code %}

                <div class="video-player" id="video-player-{{ video.id }}">
                    <div>
                        <a href="#!/close_player?vid={{ video.id }}" class="video-player-close"></a>
                    </div>
                    <div class='video-embed-container' id="video-embed-container-{{ video.id }}">
                    {% autoescape off %}
                        {{ video.html_embed_code }}
                    {% endautoescape %}
                    </div>
                </div>

                {% else %}

                <div class="video-player" id="video-player-{{ video.id }}"
                        style="background-color:#DEDEDE;font-size:16px;">
                    <div>
                        <a href="#!/close_player?vid={{ video.id }}" class="video-player-close"></a>
                    </div>
                    <div class='video-embed-container' id="video-embed-container-{{ video.id }}">
                        <div class="video-no-embed-link">
                            The host of the video you have selected requests that
                            you access it at<br>
                            <a href="{{ video.url }}" target="_blank">{{ video.url }}</a>
                        </div>
                    </div>
                </div>

                {% endif %}
            </div>
            <div class="my-video-breaker"></div>
        </div>
    {% endfor %}
{% endblock content%}